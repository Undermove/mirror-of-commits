<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>🎰 Open Source Resurrection Machine</title>
<style>
body{
  margin:0;
  background:radial-gradient(circle at center,#0a0a0a,#000);
  color:#0f0;
  font-family:"Courier New",monospace;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  height:100vh;
  overflow:hidden;
}
h1{
  color:#00ff9d;
  text-shadow:0 0 10px #00ff9d;
  margin-bottom:20px;
}
.machine{
  position:relative;
  width:600px;
  height:420px;
  background:#111;
  border:4px solid #0f0;
  border-radius:25px;
  box-shadow:0 0 40px #0f0 inset,0 0 60px #040;
  padding:20px;
}
.reels{
  display:flex;
  justify-content:center;
  gap:25px;
  perspective:900px;
  margin-top:40px;
}
.reel{
  width:140px;
  height:200px;
  background:#020;
  border:2px solid #0f0;
  border-radius:10px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:1.1rem;
  color:#0f0;
  box-shadow:inset 0 0 20px #000;
  transform-style:preserve-3d;
}
.reel.spin{
  animation:spin 0.5s linear infinite;
}
@keyframes spin{
  from{transform:rotateX(0deg);}
  to{transform:rotateX(-360deg);}
}
button{
  background:#000;
  color:#0f0;
  border:2px solid #0f0;
  border-radius:8px;
  font-size:1.3rem;
  padding:10px 30px;
  margin-top:25px;
  cursor:pointer;
  transition:0.2s;
}
button:hover{
  background:#0f0;
  color:#000;
}
#msg{margin-top:15px;font-size:1rem;opacity:0.8;}
#counter{margin-top:10px;color:#0f0;}
/* lever (decor) */
.lever{
  position:absolute;
  right:-50px;
  top:120px;
  width:15px;
  height:160px;
  background:#333;
  border:2px solid #0f0;
  border-radius:10px;
}
.lever::after{
  content:'';
  position:absolute;
  bottom:-25px;
  left:-10px;
  width:35px;
  height:35px;
  background:#800;
  border:2px solid #0f0;
  border-radius:50%;
  box-shadow:0 0 15px red;
}
</style>
</head>
<body>
<h1>🪦 Open Source Resurrection Machine</h1>
<div class="machine">
  <div class="lever"></div>
  <div class="reels">
    <div class="reel" id="r1">💀</div>
    <div class="reel" id="r2">💀</div>
    <div class="reel" id="r3">💀</div>
  </div>
  <button id="spin">🎰 SPIN</button>
  <div id="msg"></div>
  <div id="counter"></div>
</div>

<audio id="spinSound" src="https://cdn.jsdelivr.net/gh/anars/blank-audio/1-second-of-silence.mp3" preload="auto"></audio>
<audio id="dingSound" src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg" preload="auto"></audio>

<script>
const reels=document.querySelectorAll(".reel");
const spinBtn=document.getElementById("spin");
const msg=document.getElementById("msg");
const counter=document.getElementById("counter");
const spinSound=document.getElementById("spinSound");
const dingSound=document.getElementById("dingSound");
let souls=Number(localStorage.getItem("soulsRevived")||0);
counter.innerText=`✨ Souls revived today: ${souls}`;

async function getRepos(){
  const page=Math.floor(Math.random()*30)+1;
  const url=`https://api.github.com/search/repositories?q=stars:>1000+pushed:<2021-01-01+archived:false&sort=stars&order=desc&per_page=3&page=${page}`;
  const resp=await fetch(url);
  const data=await resp.json();
  return data.items||[];
}

function startSpin(){
  msg.innerText="⚙️ Spinning the machine...";
  reels.forEach(r=>r.classList.add("spin"));
  spinSound.play();
}

function stopSpin(data){
  reels.forEach((r,i)=>{
    setTimeout(()=>{
      r.classList.remove("spin");
      const repo=data[i];
      if(!repo){r.innerHTML="💀 Empty tomb";return;}
      const year=new Date(repo.pushed_at).getFullYear();
      r.innerHTML=`<div style="text-align:center">
      <strong>🪦 ${repo.name}</strong><br>
      ⭐ ${repo.stargazers_count}<br>
      🕰 ${year}<br>
      <a href="${repo.html_url}" target="_blank" style="color:#0f0;text-decoration:none;">Bless ↗</a>
      </div>`;
      r.querySelector("a").onclick=()=>{
        souls++;
        localStorage.setItem("soulsRevived",souls);
        counter.innerText=`✨ Souls revived today: ${souls}`;
        msg.innerText="💫 One forgotten repo feels warmth again...";
        dingSound.play();
      };
      if(i===2) msg.innerText="Choose one to bless ⭐";
    },2500+i*600);
  });
}

spinBtn.onclick=async()=>{
  startSpin();
  try{
    const data=await getRepos();
    setTimeout(()=>stopSpin(data),2500);
  }catch(e){
    msg.innerText="⚠️ Spirits refused to answer.";
    reels.forEach(r=>r.classList.remove("spin"));
  }
};
</script>
</body>
</html>
