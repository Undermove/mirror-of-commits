<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>ğŸ° Open Source Resurrection Machine</title>
<style>
body{
  margin:0;
  background:radial-gradient(circle at center,#0a0a0a,#000);
  color:#0f0;
  font-family:"Courier New",monospace;
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  height:100vh;overflow:hidden;
}
h1{color:#00ff9d;text-shadow:0 0 10px #00ff9d;margin-bottom:10px;}
.machine{
  position:relative;width:600px;height:420px;
  background:#111;border:4px solid #0f0;border-radius:25px;
  box-shadow:0 0 40px #0f0 inset,0 0 60px #040;padding:20px;
}
.reels{
  display:flex;justify-content:center;gap:25px;perspective:900px;margin-top:40px;
}
.reel{
  width:140px;height:200px;background:#020;border:2px solid #0f0;
  border-radius:10px;display:flex;align-items:center;justify-content:center;
  font-size:1.1rem;color:#0f0;box-shadow:inset 0 0 20px #000;
  transform-style:preserve-3d;cursor:pointer;transition:0.3s;
}
.reel:hover{box-shadow:0 0 15px #0f0;}
.reel.spin{animation:spin 0.5s linear infinite;}
@keyframes spin{from{transform:rotateX(0deg);}to{transform:rotateX(-360deg);}}
#msg{margin-top:25px;font-size:1rem;opacity:0.8;text-align:center;width:80%;}
#counter{margin-top:10px;color:#0f0;}
/* lever */
.lever{
  position:absolute;right:-60px;top:100px;width:20px;height:180px;
  background:#333;border:2px solid #0f0;border-radius:10px;cursor:pointer;
  transform-origin:top center;transition:transform 0.3s;
}
.lever::after{
  content:'';position:absolute;bottom:-30px;left:-12px;width:44px;height:44px;
  background:#800;border:2px solid #0f0;border-radius:50%;box-shadow:0 0 15px red;
}
.lever.pulled{transform:rotate(35deg);}
</style>
</head>
<body>
<h1>ğŸª¦ Open Source Resurrection Machine</h1>
<div class="machine">
  <div class="lever" id="lever" title="Pull the lever"></div>
  <div class="reels">
    <div class="reel" id="r1">ğŸ’€</div>
    <div class="reel" id="r2">ğŸ’€</div>
    <div class="reel" id="r3">ğŸ’€</div>
  </div>
  <div id="msg">â˜ ï¸ Pull the lever to see dead repositories</div>
  <div id="counter"></div>
</div>

<audio id="spinSound" src="https://actions.google.com/sounds/v1/transportation/train_wheels_loop.ogg" preload="auto"></audio>
<audio id="dingSound" src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg" preload="auto"></audio>

<script>
const reels=document.querySelectorAll(".reel");
const lever=document.getElementById("lever");
const msg=document.getElementById("msg");
const counter=document.getElementById("counter");
const spinSound=document.getElementById("spinSound");
const dingSound=document.getElementById("dingSound");
let souls=Number(localStorage.getItem("soulsRevived")||0);
counter.innerText=`âœ¨ Souls revived today: ${souls}`;

let isSpinning=false;

async function getRepos(){
  const page=Math.floor(Math.random()*30)+1;
  const url=`https://api.github.com/search/repositories?q=stars:>1000+pushed:<2021-01-01+archived:false&sort=stars&order=desc&per_page=3&page=${page}`;
  const resp=await fetch(url);
  const data=await resp.json();
  return data.items||[];
}

function startSpin(){
  if(isSpinning) return;
  isSpinning=true;
  lever.classList.add("pulled");
  msg.innerText="âš™ï¸ Spinning...";
  reels.forEach(r=>r.classList.add("spin"));
  spinSound.play();
}

function stopSpin(data){
  reels.forEach((r,i)=>{
    setTimeout(()=>{
      r.classList.remove("spin");
      const repo=data[i];
      if(!repo){r.innerHTML="ğŸ’€ Empty tomb";return;}
      const year=new Date(repo.pushed_at).getFullYear();
      r.innerHTML=`<div style="text-align:center;pointer-events:none">
      <strong>ğŸª¦ ${repo.name}</strong><br>
      â­ ${repo.stargazers_count}<br>ğŸ•° ${year}
      </div>`;
      r.onclick=()=>{window.open(repo.html_url,"_blank");souls++;
        localStorage.setItem("soulsRevived",souls);
        counter.innerText=`âœ¨ Souls revived today: ${souls}`;
        msg.innerText="â­ Light a star to bless one of them";
        dingSound.play();
      };
      if(i===2){
        msg.innerText="â­ Light a star to bless one of them";
        lever.classList.remove("pulled");
        isSpinning=false;
      }
    },2200+i*600);
  });
}

async function pullLever(){
  startSpin();
  try{
    const data=await getRepos();
    setTimeout(()=>stopSpin(data),2500);
  }catch(e){
    msg.innerText="âš ï¸ Spirits refused to answer.";
    reels.forEach(r=>r.classList.remove("spin"));
    lever.classList.remove("pulled");
    isSpinning=false;
  }
}

let dragging=false,startY=0;
lever.addEventListener("mousedown",e=>{dragging=true;startY=e.clientY;});
window.addEventListener("mouseup",e=>{
  if(!dragging)return;dragging=false;
  if(startY && e.clientY-startY>60){pullLever();}
});
lever.addEventListener("touchstart",e=>{dragging=true;startY=e.touches[0].clientY;});
window.addEventListener("touchend",e=>{
  if(!dragging)return;dragging=false;
  if(startY && e.changedTouches[0].clientY-startY>60){pullLever();}
});
</script>
</body>
</html>
